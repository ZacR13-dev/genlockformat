<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GenLock Tracker - PokÃ©mon Challenge</title>
    
    <!-- Styles CSS modulaires -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/save-import.css">
</head>
<body>
    <div class="container">
        <!-- ============================================
             HEADER - En-tÃªte avec titre et contrÃ´les
             ============================================ -->
        <header>
            <h1>ğŸ® GenLock Tracker</h1>
            <div style="display: flex; gap: 10px;">
                <button class="theme-toggle" onclick="toggleLanguage()" title="Change language">
                    <span id="langIcon">ğŸ‡¬ğŸ‡§</span>
                </button>
                <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
                    <span id="themeIcon">ğŸŒ™</span>
                </button>
            </div>
        </header>

        <!-- ============================================
             NAVIGATION - Onglets principaux
             ============================================ -->
        <nav class="tabs">
            <button class="tab-btn active" onclick="switchTab('tracker')" data-tab="tracker">
                ğŸ® Tracker
            </button>
            <button class="tab-btn" onclick="switchTab('stats')" data-tab="stats">
                ğŸ“Š Statistiques
            </button>
            <button class="tab-btn" onclick="switchTab('rules')" data-tab="rules">
                ğŸ“œ RÃ¨gles
            </button>
        </nav>

        <!-- ============================================
             ONGLET TRACKER - Gestion des jeux et PokÃ©mon
             ============================================ -->
        <div id="trackerTab" class="tab-content active">
            <!-- Boutons de contrÃ´le -->
            <div class="controls">
                <button class="btn btn-primary" onclick="addGame()" data-i18n="btn.addGame">
                    â• Add Game
                </button>
                <button class="btn btn-primary" onclick="document.getElementById('savFile').click()" data-i18n="btn.importSave">
                    ğŸ® Import ROM Save
                </button>
                <input type="file" id="savFile" style="display: none" accept=".sav,.dst,.dsv,.sa1,.0" onchange="importSaveFile(event)">
                <button class="btn btn-success" onclick="saveData()" data-i18n="btn.save">
                    ğŸ’¾ Save
                </button>
                <button class="btn btn-secondary" onclick="exportAsImage()" data-i18n="btn.exportImage">
                    ğŸ“¸ Export as Image
                </button>
                <button class="btn btn-secondary" onclick="exportData()" data-i18n="btn.exportJSON">
                    ğŸ“¤ Export JSON
                </button>
                <button class="btn btn-secondary" onclick="document.getElementById('importFile').click()" data-i18n="btn.importJSON">
                    ğŸ“¥ Import JSON
                </button>
                <input type="file" id="importFile" style="display: none" accept=".json" onchange="importData(event)">
                <button class="btn btn-danger" onclick="resetAll()" data-i18n="btn.reset">
                    ğŸ”„ Reset All
                </button>
            </div>

            <!-- Conteneur des jeux -->
            <div class="main-content">
                <div class="games-container" id="gamesContainer">
                    <!-- Les jeux seront ajoutÃ©s ici dynamiquement -->
                </div>
            </div>

            <!-- Statistiques rapides -->
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="totalGames">0</div>
                    <div class="stat-label" data-i18n="stats.games">Games</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="totalChampions">0</div>
                    <div class="stat-label" data-i18n="stats.champions">Champions</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="totalRetired">0</div>
                    <div class="stat-label" data-i18n="stats.retired">Retired</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="totalDead">0</div>
                    <div class="stat-label" data-i18n="stats.dead">Dead</div>
                </div>
            </div>
        </div>

        <!-- ============================================
             ONGLET STATISTIQUES - Dashboard et analytics
             ============================================ -->
        <div id="statsTab" class="tab-content">
            <div class="dashboard">
                <h2 class="dashboard-title">ğŸ“Š Dashboard GenLock</h2>
                
                <!-- Cartes de statistiques principales -->
                <div class="stats-overview">
                    <div class="stat-card">
                        <div class="stat-card-icon">ğŸ®</div>
                        <div class="stat-card-content">
                            <div class="stat-card-value" id="dashTotalGames">0</div>
                            <div class="stat-card-label">Jeux Actifs</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-card-icon">ğŸ†</div>
                        <div class="stat-card-content">
                            <div class="stat-card-value" id="dashTotalChampions">0</div>
                            <div class="stat-card-label">Champions Actifs</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-card-icon">ğŸ’€</div>
                        <div class="stat-card-content">
                            <div class="stat-card-value" id="dashTotalDead">0</div>
                            <div class="stat-card-label">Fallen Heroes</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-card-icon">ğŸ“ˆ</div>
                        <div class="stat-card-content">
                            <div class="stat-card-value" id="dashSurvivalRate">0%</div>
                            <div class="stat-card-label">Taux de Survie</div>
                        </div>
                    </div>
                </div>

                <!-- Stats par gÃ©nÃ©ration -->
                <div class="stats-section">
                    <h3>ğŸ“Š Statistiques par GÃ©nÃ©ration</h3>
                    <div id="statsByGen" class="stats-by-gen"></div>
                </div>

                <!-- Top 10 PokÃ©mon -->
                <div class="stats-section">
                    <h3>â­ Top 10 PokÃ©mon les plus utilisÃ©s</h3>
                    <div id="topPokemon" class="top-pokemon-list"></div>
                </div>

                <!-- Hall of Fame -->
                <div class="stats-section">
                    <h3>ğŸ† Hall of Fame - Survivors</h3>
                    <p class="section-description">PokÃ©mon ayant survÃ©cu dans plusieurs jeux</p>
                    <div id="hallOfFame" class="hall-of-fame"></div>
                </div>

                <!-- Fallen Heroes -->
                <div class="stats-section">
                    <h3>ğŸ’€ Fallen Heroes</h3>
                    <p class="section-description">Liste globale des PokÃ©mon tombÃ©s au combat</p>
                    <div id="fallenHeroes" class="fallen-heroes"></div>
                </div>
            </div>
        </div>

        <!-- ============================================
             ONGLET RÃˆGLES - Explication du GenLocke
             ============================================ -->
        <div id="rulesTab" class="tab-content">
            <div class="rules-container" style="padding: 20px; background: var(--bg-secondary); border-radius: 8px;">
                <h2 style="border-bottom: 2px solid var(--border-color); padding-bottom: 10px;">ğŸ“œ RÃ¨gles du GenLocke</h2>
                <p>Le GenLocke est une variante du Nuzlocke qui se joue sur plusieurs gÃ©nÃ©rations de jeux PokÃ©mon. Les rÃ¨gles de base du Nuzlocke s'appliquent, avec des ajouts spÃ©cifiques pour lier les jeux entre eux.</p>

                <h3 style="margin-top: 20px;">RÃ¨gles Fondamentales (Nuzlocke)</h3>
                <ul style="list-style-type: disc; padding-left: 20px;">
                    <li><strong>Capture unique :</strong> Vous ne pouvez capturer que le premier PokÃ©mon rencontrÃ© dans chaque nouvelle zone. De plus, une espÃ¨ce de PokÃ©mon (et sa famille Ã©volutive) ne peut Ãªtre capturÃ©e qu'<strong>une seule fois</strong> sur l'ensemble du GenLocke.</li>
                    <li><strong>Mort permanente :</strong> Si un PokÃ©mon est mis K.O., il est considÃ©rÃ© comme "mort" et doit Ãªtre relÃ¢chÃ© ou placÃ© dans une boÃ®te "CimetiÃ¨re" pour ne plus jamais Ãªtre utilisÃ©.</li>
                    <li><strong>Surnoms obligatoires :</strong> Vous devez donner un surnom Ã  chaque PokÃ©mon capturÃ© pour renforcer le lien Ã©motionnel.</li>
                </ul>

                <h3 style="margin-top: 20px;">RÃ¨gles SpÃ©cifiques (GenLocke)</h3>
                <ul style="list-style-type: disc; padding-left: 20px;">
                    <li><strong>HÃ©ritage des Champions :</strong> Ã€ la fin d'un jeu (aprÃ¨s avoir battu le MaÃ®tre de la Ligue), les PokÃ©mon survivants de votre Ã©quipe finale sont considÃ©rÃ©s comme des "Champions".</li>
                    <li><strong>Transmission :</strong> Les "Champions" peuvent Ãªtre "transmis" au jeu suivant de la sÃ©rie. Leurs descendants (gÃ©nÃ©ralement des Å“ufs de leur premiÃ¨re forme Ã©volutive) commenceront l'aventure avec vous dans le nouveau jeu.</li>
                    <li><strong>ContinuitÃ© :</strong> Le but est de conserver une lignÃ©e de survivants Ã  travers autant de gÃ©nÃ©rations que possible. Si vous perdez tous vos PokÃ©mon (wipe), le GenLocke est terminÃ©.</li>
                </ul>

                <h3 style="margin-top: 20px;">Clauses Optionnelles Populaires</h3>
                <ul style="list-style-type: disc; padding-left: 20px;">
                    <li><strong>Clause du Duplicata :</strong> Si votre premiÃ¨re rencontre dans une zone est un PokÃ©mon que vous avez dÃ©jÃ  capturÃ© (ou un membre de sa famille Ã©volutive), vous pouvez ignorer cette rencontre et chercher jusqu'Ã  en trouver un nouveau.</li>
                    <li><strong>Clause du Shiny :</strong> Si vous rencontrez un PokÃ©mon chromatique (shiny), vous Ãªtes autorisÃ© Ã  le capturer, mÃªme si ce n'est pas votre premiÃ¨re rencontre dans la zone.</li>
                    <li><strong>Plafond de Niveau (Level Cap) :</strong> Pour un combat de Champion d'ArÃ¨ne ou de MaÃ®tre de la Ligue, aucun de vos PokÃ©mon ne peut avoir un niveau supÃ©rieur Ã  celui du PokÃ©mon le plus fort de l'adversaire.</li>
                    <li><strong>Clause des Objets :</strong> L'utilisation d'objets de soin en combat (comme les Potions) est interdite, Ã  moins qu'un dresseur adverse n'en utilise un en premier. Les objets de guÃ©rison de statut restent autorisÃ©s.</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- ============================================
         MODAL - SÃ©lection de jeu
         ============================================ -->
    <div class="modal" id="addGameModal" onclick="if(event.target === this) closeModal()">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h2 data-i18n="modal.selectGame">Select a Game</h2>
                <button class="modal-close" onclick="closeModal()" data-i18n-title="modal.close" title="Close">Ã—</button>
            </div>
            <div class="modal-body">
                <div id="gameSelection" class="game-selection-grid"></div>
            </div>
        </div>
    </div>

    <!-- ============================================
         MODAL - SÃ©lection de PokÃ©mon
         ============================================ -->
    <div class="modal" id="addPokemonModal" onclick="if(event.target === this) closePokemonModal()">
        <div class="modal-content">
            <div class="modal-header">
                <h2 data-i18n="modal.selectPokemon">Select a PokÃ©mon</h2>
                <button class="modal-close" onclick="closePokemonModal()" data-i18n-title="modal.close" title="Close">Ã—</button>
            </div>
            <div class="modal-body">
                <input type="text" id="pokemonSearch" data-i18n-placeholder="modal.searchPokemon" 
                       placeholder="Search for a PokÃ©mon..." 
                       style="width: 100%; padding: 8px; margin-bottom: 15px; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-tertiary); color: var(--text-primary);">
                <div id="pokemonSelection" class="pokemon-selection-grid"></div>
            </div>
        </div>
    </div>

    <!-- ============================================
         MODAL - DÃ©tails PokÃ©mon
         ============================================ -->
    <div class="modal pokemon-details-modal" id="pokemonDetailsModal" onclick="if(event.target === this) closePokemonDetailsModal()">
        <div class="modal-content">
            <div class="modal-header">
                <h2>DÃ©tails du PokÃ©mon</h2>
                <button class="modal-close" onclick="closePokemonDetailsModal()" title="Close">Ã—</button>
            </div>
            <div class="modal-body" id="pokemonDetailsContent">
                <!-- Le contenu sera gÃ©nÃ©rÃ© dynamiquement -->
            </div>
        </div>
    </div>

    <!-- ============================================
         SCRIPTS - Chargement des modules JavaScript
         ============================================ -->
    
    <!-- Internationalisation et parseurs -->
    <script src="js/i18n.js"></script>
    
    <!-- âœ… PokeAPI - IntÃ©gration de l'API pour les sprites -->
    <script src="js/pokeapi.js"></script>
    
    <!-- âœ… IMPORTANT: pokemon-data.js DOIT Ãªtre chargÃ© EN PREMIER -->
    <!-- Car il dÃ©finit PokemonData et pokemonNames utilisÃ©s partout -->
    <script src="js/pokemon-data.js"></script>
    
    <script src="js/backend-api.js"></script>
    <script src="js/pkhex-backend.js"></script>
    <script src="js/savParser.js"></script>
    <script src="js/save-importer.js"></script>
    <script src="js/exportImage.js"></script>
    
    <!-- Modules de l'application (ordre important!) -->
    <script src="js/config.js"></script>
    <script src="js/state.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/theme.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/games.js"></script>
    <script src="js/pokemon.js"></script>
    <script src="js/drag-drop.js"></script>
    <script src="js/render.js"></script>
    <script src="js/tabs.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/pokemon-details.js"></script>
    
    <!-- Initialisation (doit Ãªtre en dernier) -->
    <script src="js/init.js"></script>
</body>
</html>
